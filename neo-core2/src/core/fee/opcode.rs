use crate::vm::opcode::Opcode;

// Opcode returns the deployment coefficients of the specified opcodes.
pub fn opcode(base: i64, opcodes: &[Opcode]) -> i64 {
    let mut result: i64 = 0;
    for &op in opcodes {
        result += coefficients[op as usize] as i64;
    }
    result * base
}

const COEFFICIENTS: [u16; 256] = {
    let mut coefficients = [0u16; 256];
    coefficients[Opcode::PUSHINT8 as usize] = 1 << 0;
    coefficients[Opcode::PUSHINT16 as usize] = 1 << 0;
    coefficients[Opcode::PUSHINT32 as usize] = 1 << 0;
    coefficients[Opcode::PUSHINT64 as usize] = 1 << 0;
    coefficients[Opcode::PUSHINT128 as usize] = 1 << 2;
    coefficients[Opcode::PUSHINT256 as usize] = 1 << 2;
    coefficients[Opcode::PUSHT as usize] = 1 << 0;
    coefficients[Opcode::PUSHF as usize] = 1 << 0;
    coefficients[Opcode::PUSHA as usize] = 1 << 2;
    coefficients[Opcode::PUSHNULL as usize] = 1 << 0;
    coefficients[Opcode::PUSHDATA1 as usize] = 1 << 3;
    coefficients[Opcode::PUSHDATA2 as usize] = 1 << 9;
    coefficients[Opcode::PUSHDATA4 as usize] = 1 << 12;
    coefficients[Opcode::PUSHM1 as usize] = 1 << 0;
    coefficients[Opcode::PUSH0 as usize] = 1 << 0;
    coefficients[Opcode::PUSH1 as usize] = 1 << 0;
    coefficients[Opcode::PUSH2 as usize] = 1 << 0;
    coefficients[Opcode::PUSH3 as usize] = 1 << 0;
    coefficients[Opcode::PUSH4 as usize] = 1 << 0;
    coefficients[Opcode::PUSH5 as usize] = 1 << 0;
    coefficients[Opcode::PUSH6 as usize] = 1 << 0;
    coefficients[Opcode::PUSH7 as usize] = 1 << 0;
    coefficients[Opcode::PUSH8 as usize] = 1 << 0;
    coefficients[Opcode::PUSH9 as usize] = 1 << 0;
    coefficients[Opcode::PUSH10 as usize] = 1 << 0;
    coefficients[Opcode::PUSH11 as usize] = 1 << 0;
    coefficients[Opcode::PUSH12 as usize] = 1 << 0;
    coefficients[Opcode::PUSH13 as usize] = 1 << 0;
    coefficients[Opcode::PUSH14 as usize] = 1 << 0;
    coefficients[Opcode::PUSH15 as usize] = 1 << 0;
    coefficients[Opcode::PUSH16 as usize] = 1 << 0;
    coefficients[Opcode::NOP as usize] = 1 << 0;
    coefficients[Opcode::JMP as usize] = 1 << 1;
    coefficients[Opcode::JMPL as usize] = 1 << 1;
    coefficients[Opcode::JMPIF as usize] = 1 << 1;
    coefficients[Opcode::JMPIFL as usize] = 1 << 1;
    coefficients[Opcode::JMPIFNOT as usize] = 1 << 1;
    coefficients[Opcode::JMPIFNOTL as usize] = 1 << 1;
    coefficients[Opcode::JMPEQ as usize] = 1 << 1;
    coefficients[Opcode::JMPEQL as usize] = 1 << 1;
    coefficients[Opcode::JMPNE as usize] = 1 << 1;
    coefficients[Opcode::JMPNEL as usize] = 1 << 1;
    coefficients[Opcode::JMPGT as usize] = 1 << 1;
    coefficients[Opcode::JMPGTL as usize] = 1 << 1;
    coefficients[Opcode::JMPGE as usize] = 1 << 1;
    coefficients[Opcode::JMPGEL as usize] = 1 << 1;
    coefficients[Opcode::JMPLT as usize] = 1 << 1;
    coefficients[Opcode::JMPLTL as usize] = 1 << 1;
    coefficients[Opcode::JMPLE as usize] = 1 << 1;
    coefficients[Opcode::JMPLEL as usize] = 1 << 1;
    coefficients[Opcode::CALL as usize] = 1 << 9;
    coefficients[Opcode::CALLL as usize] = 1 << 9;
    coefficients[Opcode::CALLA as usize] = 1 << 9;
    coefficients[Opcode::CALLT as usize] = 1 << 15;
    coefficients[Opcode::ABORT as usize] = 0;
    coefficients[Opcode::ASSERT as usize] = 1 << 0;
    coefficients[Opcode::ABORTMSG as usize] = 0;      // TODO
    coefficients[Opcode::ASSERTMSG as usize] = 1 << 0; // TODO
    coefficients[Opcode::THROW as usize] = 1 << 9;
    coefficients[Opcode::TRY as usize] = 1 << 2;
    coefficients[Opcode::TRYL as usize] = 1 << 2;
    coefficients[Opcode::ENDTRY as usize] = 1 << 2;
    coefficients[Opcode::ENDTRYL as usize] = 1 << 2;
    coefficients[Opcode::ENDFINALLY as usize] = 1 << 2;
    coefficients[Opcode::RET as usize] = 0;
    coefficients[Opcode::SYSCALL as usize] = 0;
    coefficients[Opcode::DEPTH as usize] = 1 << 1;
    coefficients[Opcode::DROP as usize] = 1 << 1;
    coefficients[Opcode::NIP as usize] = 1 << 1;
    coefficients[Opcode::XDROP as usize] = 1 << 4;
    coefficients[Opcode::CLEAR as usize] = 1 << 4;
    coefficients[Opcode::DUP as usize] = 1 << 1;
    coefficients[Opcode::OVER as usize] = 1 << 1;
    coefficients[Opcode::PICK as usize] = 1 << 1;
    coefficients[Opcode::TUCK as usize] = 1 << 1;
    coefficients[Opcode::SWAP as usize] = 1 << 1;
    coefficients[Opcode::ROT as usize] = 1 << 1;
    coefficients[Opcode::ROLL as usize] = 1 << 4;
    coefficients[Opcode::REVERSE3 as usize] = 1 << 1;
    coefficients[Opcode::REVERSE4 as usize] = 1 << 1;
    coefficients[Opcode::REVERSEN as usize] = 1 << 4;
    coefficients[Opcode::INITSSLOT as usize] = 1 << 4;
    coefficients[Opcode::INITSLOT as usize] = 1 << 6;
    coefficients[Opcode::LDSFLD0 as usize] = 1 << 1;
    coefficients[Opcode::LDSFLD1 as usize] = 1 << 1;
    coefficients[Opcode::LDSFLD2 as usize] = 1 << 1;
    coefficients[Opcode::LDSFLD3 as usize] = 1 << 1;
    coefficients[Opcode::LDSFLD4 as usize] = 1 << 1;
    coefficients[Opcode::LDSFLD5 as usize] = 1 << 1;
    coefficients[Opcode::LDSFLD6 as usize] = 1 << 1;
    coefficients[Opcode::LDSFLD as usize] = 1 << 1;
    coefficients[Opcode::STSFLD0 as usize] = 1 << 1;
    coefficients[Opcode::STSFLD1 as usize] = 1 << 1;
    coefficients[Opcode::STSFLD2 as usize] = 1 << 1;
    coefficients[Opcode::STSFLD3 as usize] = 1 << 1;
    coefficients[Opcode::STSFLD4 as usize] = 1 << 1;
    coefficients[Opcode::STSFLD5 as usize] = 1 << 1;
    coefficients[Opcode::STSFLD6 as usize] = 1 << 1;
    coefficients[Opcode::STSFLD as usize] = 1 << 1;
    coefficients[Opcode::LDLOC0 as usize] = 1 << 1;
    coefficients[Opcode::LDLOC1 as usize] = 1 << 1;
    coefficients[Opcode::LDLOC2 as usize] = 1 << 1;
    coefficients[Opcode::LDLOC3 as usize] = 1 << 1;
    coefficients[Opcode::LDLOC4 as usize] = 1 << 1;
    coefficients[Opcode::LDLOC5 as usize] = 1 << 1;
    coefficients[Opcode::LDLOC6 as usize] = 1 << 1;
    coefficients[Opcode::LDLOC as usize] = 1 << 1;
    coefficients[Opcode::STLOC0 as usize] = 1 << 1;
    coefficients[Opcode::STLOC1 as usize] = 1 << 1;
    coefficients[Opcode::STLOC2 as usize] = 1 << 1;
    coefficients[Opcode::STLOC3 as usize] = 1 << 1;
    coefficients[Opcode::STLOC4 as usize] = 1 << 1;
    coefficients[Opcode::STLOC5 as usize] = 1 << 1;
    coefficients[Opcode::STLOC6 as usize] = 1 << 1;
    coefficients[Opcode::STLOC as usize] = 1 << 1;
    coefficients[Opcode::LDARG0 as usize] = 1 << 1;
    coefficients[Opcode::LDARG1 as usize] = 1 << 1;
    coefficients[Opcode::LDARG2 as usize] = 1 << 1;
    coefficients[Opcode::LDARG3 as usize] = 1 << 1;
    coefficients[Opcode::LDARG4 as usize] = 1 << 1;
    coefficients[Opcode::LDARG5 as usize] = 1 << 1;
    coefficients[Opcode::LDARG6 as usize] = 1 << 1;
    coefficients[Opcode::LDARG as usize] = 1 << 1;
    coefficients[Opcode::STARG0 as usize] = 1 << 1;
    coefficients[Opcode::STARG1 as usize] = 1 << 1;
    coefficients[Opcode::STARG2 as usize] = 1 << 1;
    coefficients[Opcode::STARG3 as usize] = 1 << 1;
    coefficients[Opcode::STARG4 as usize] = 1 << 1;
    coefficients[Opcode::STARG5 as usize] = 1 << 1;
    coefficients[Opcode::STARG6 as usize] = 1 << 1;
    coefficients[Opcode::STARG as usize] = 1 << 1;
    coefficients[Opcode::NEWBUFFER as usize] = 1 << 8;
    coefficients[Opcode::MEMCPY as usize] = 1 << 11;
    coefficients[Opcode::CAT as usize] = 1 << 11;
    coefficients[Opcode::SUBSTR as usize] = 1 << 11;
    coefficients[Opcode::LEFT as usize] = 1 << 11;
    coefficients[Opcode::RIGHT as usize] = 1 << 11;
    coefficients[Opcode::INVERT as usize] = 1 << 2;
    coefficients[Opcode::AND as usize] = 1 << 3;
    coefficients[Opcode::OR as usize] = 1 << 3;
    coefficients[Opcode::XOR as usize] = 1 << 3;
    coefficients[Opcode::EQUAL as usize] = 1 << 5;
    coefficients[Opcode::NOTEQUAL as usize] = 1 << 5;
    coefficients[Opcode::SIGN as usize] = 1 << 2;
    coefficients[Opcode::ABS as usize] = 1 << 2;
    coefficients[Opcode::NEGATE as usize] = 1 << 2;
    coefficients[Opcode::INC as usize] = 1 << 2;
    coefficients[Opcode::DEC as usize] = 1 << 2;
    coefficients[Opcode::ADD as usize] = 1 << 3;
    coefficients[Opcode::SUB as usize] = 1 << 3;
    coefficients[Opcode::MUL as usize] = 1 << 3;
    coefficients[Opcode::DIV as usize] = 1 << 3;
    coefficients[Opcode::MOD as usize] = 1 << 3;
    coefficients[Opcode::POW as usize] = 1 << 6;
    coefficients[Opcode::SQRT as usize] = 1 << 6;
    coefficients[Opcode::MODMUL as usize] = 1 << 5;
    coefficients[Opcode::MODPOW as usize] = 1 << 11;
    coefficients[Opcode::SHL as usize] = 1 << 3;
    coefficients[Opcode::SHR as usize] = 1 << 3;
    coefficients[Opcode::NOT as usize] = 1 << 2;
    coefficients[Opcode::BOOLAND as usize] = 1 << 3;
    coefficients[Opcode::BOOLOR as usize] = 1 << 3;
    coefficients[Opcode::NZ as usize] = 1 << 2;
    coefficients[Opcode::NUMEQUAL as usize] = 1 << 3;
    coefficients[Opcode::NUMNOTEQUAL as usize] = 1 << 3;
    coefficients[Opcode::LT as usize] = 1 << 3;
    coefficients[Opcode::LE as usize] = 1 << 3;
    coefficients[Opcode::GT as usize] = 1 << 3;
    coefficients[Opcode::GE as usize] = 1 << 3;
    coefficients[Opcode::MIN as usize] = 1 << 3;
    coefficients[Opcode::MAX as usize] = 1 << 3;
    coefficients[Opcode::WITHIN as usize] = 1 << 3;
    coefficients[Opcode::PACKMAP as usize] = 1 << 11;
    coefficients[Opcode::PACKSTRUCT as usize] = 1 << 11;
    coefficients[Opcode::PACK as usize] = 1 << 11;
    coefficients[Opcode::UNPACK as usize] = 1 << 11;
    coefficients[Opcode::NEWARRAY0 as usize] = 1 << 4;
    coefficients[Opcode::NEWARRAY as usize] = 1 << 9;
    coefficients[Opcode::NEWARRAYT as usize] = 1 << 9;
    coefficients[Opcode::NEWSTRUCT0 as usize] = 1 << 4;
    coefficients[Opcode::NEWSTRUCT as usize] = 1 << 9;
    coefficients[Opcode::NEWMAP as usize] = 1 << 3;
    coefficients[Opcode::SIZE as usize] = 1 << 2;
    coefficients[Opcode::HASKEY as usize] = 1 << 6;
    coefficients[Opcode::KEYS as usize] = 1 << 4;
    coefficients[Opcode::VALUES as usize] = 1 << 13;
    coefficients[Opcode::PICKITEM as usize] = 1 << 6;
    coefficients[Opcode::APPEND as usize] = 1 << 13;
    coefficients[Opcode::SETITEM as usize] = 1 << 13;
    coefficients[Opcode::REVERSEITEMS as usize] = 1 << 13;
    coefficients[Opcode::REMOVE as usize] = 1 << 4;
    coefficients[Opcode::CLEARITEMS as usize] = 1 << 4;
    coefficients[Opcode::POPITEM as usize] = 1 << 4;
    coefficients[Opcode::ISNULL as usize] = 1 << 1;
    coefficients[Opcode::ISTYPE as usize] = 1 << 1;
    coefficients[Opcode::CONVERT as usize] = 1 << 13;
    coefficients
};
